<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì—„ê°€ë„¤ í˜„ì¥ ê³„ì‚°ê¸°</title>

  <style>
    :root{
      --bg:#0b0b0b;
      --panel:#151515;
      --panel2:#101010;
      --line:#242424;
      --text:#ffffff;
      --muted:#bfbfbf;
      --accent:#ff9f00;
      --danger:#ff3b30;
      --ok:#2ecc71;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", sans-serif;
      overflow:hidden; /* ì „ì²´ ìŠ¤í¬ë¡¤ ë§‰ê³ , í•„ìš”í•œ ê³³ë§Œ ìŠ¤í¬ë¡¤ */
    }

    header{
      height:58px;
      background:var(--accent);
      color:#111;
      font-weight:900;
      letter-spacing:-0.3px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:20px;
    }

    .app{
      height:calc(100vh - 58px);
      display:grid;
      grid-template-columns: 2.35fr 1fr; /* ì™¼ìª½ ë„“ê²Œ, ì˜¤ë¥¸ìª½ ê²°ì œ */
      gap:12px;
      padding:12px;
    }

    /* ===== ì™¼ìª½(í’ˆëª©) ===== */
    .left{
      min-width:0;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .topbar{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }

    .cats{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .cat-btn{
      border:1px solid var(--line);
      background: #1c1c1c;
      color:#fff;
      padding:10px 14px;
      border-radius:12px;
      font-weight:800;
      min-width:110px;
      text-align:center;
      cursor:pointer;
      user-select:none;
    }
    .cat-btn.active{
      border-color:var(--accent);
      box-shadow: inset 0 0 0 2px rgba(255,159,0,0.25);
      background:#221600;
    }

    .search{
      flex:1;
      min-width:260px;
      display:flex;
      gap:10px;
      align-items:center;
    }
    .search input{
      width:100%;
      padding:12px 14px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#0f0f0f;
      color:#fff;
      font-size:16px;
      font-weight:700;
      outline:none;
    }
    .search input::placeholder{ color:#7f7f7f; }

    .items-wrap{
      flex:1;
      min-height:0;
      border:1px solid var(--line);
      border-radius:14px;
      background:linear-gradient(180deg,#121212,#0b0b0b);
      padding:10px;
      overflow:auto; /* í’ˆëª©ë§Œ ìŠ¤í¬ë¡¤ */
    }

    /* íƒ€ì¼í˜• 4~5ì—´: í™”ë©´ ë„“ì´ì— ë”°ë¼ ìë™ */
    .items-grid{
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
      gap:10px;
    }

    .tile{
      height:92px; /* âœ… ì„¸ë¡œ ê¸´ ì‚¬ê°í˜• ë°©ì§€ */
      border:1px solid var(--line);
      border-radius:14px;
      background: #171717;
      padding:12px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      cursor:pointer;
      user-select:none;
    }
    .tile:active{ transform: translateY(1px); }

    .tile .name{
      font-size:18px;
      font-weight:900;
      letter-spacing:-0.3px;
      line-height:1.1;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .tile .price{
      font-size:18px;
      font-weight:900;
      color:#fff;
      text-align:right;
    }

    /* ===== ì˜¤ë¥¸ìª½(ì¥ë°”êµ¬ë‹ˆ/ê²°ì œ) ===== */
    .right{
      min-width:0;
      border:1px solid var(--line);
      border-radius:14px;
      background: var(--panel2);
      display:flex;
      flex-direction:column;
      overflow:hidden; /* ë‚´ë¶€ë§Œ ìŠ¤í¬ë¡¤ */
    }

    .right-header{
      padding:12px 12px 10px;
      border-bottom:1px solid var(--line);
      background:#0f0f0f;
    }

    .title-row{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:10px;
    }

    .right-title{
      font-size:20px;
      font-weight:1000;
      letter-spacing:-0.3px;
    }

    .sum{
      display:flex;
      align-items:baseline;
      gap:10px;
      justify-content:flex-end;
      font-weight:1000;
    }
    .sum .total{
      font-size:24px;
    }
    .sum .count{
      font-size:16px;
      color:var(--muted);
      font-weight:900;
      white-space:nowrap;
    }

    .cart{
      flex:1;
      min-height:0;
      overflow:auto; /* âœ… ì¥ë°”êµ¬ë‹ˆë§Œ ìŠ¤í¬ë¡¤ */
      padding:10px 10px 6px;
    }

    /* âœ… í•œ í™”ë©´ì— ìµœì†Œ 7ê°œ ì´ìƒ ë³´ì´ê²Œ ì¤„ì„ */
    .cart-item{
      display:grid;
      grid-template-columns: 1fr auto auto auto;
      gap:8px;
      align-items:center;
      padding:8px 8px;
      border:1px solid var(--line);
      border-radius:12px;
      background:#151515;
      margin-bottom:8px;
    }

    .cart-item .label{
      font-weight:900;
      font-size:14px;
      letter-spacing:-0.2px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .cart-item .amt{
      font-weight:1000;
      font-size:14px;
      min-width:86px;
      text-align:right;
    }

    .mini-btn{
      width:36px;
      height:34px;
      border:none;
      border-radius:10px;
      font-weight:1000;
      cursor:pointer;
      background:#2a2a2a;
      color:#fff;
    }
    .mini-btn.danger{ background:var(--danger); }

    .paybox{
      border-top:1px solid var(--line);
      background:#0f0f0f;
      padding:12px;
    }

    /* ë°›ì€ëˆ/ê±°ìŠ¤ë¦„: ìƒ‰ ë¶„ë¦¬ + í°íŠ¸ í¬ê²Œ */
    .money-row{
      display:flex;
      justify-content:space-between;
      align-items:baseline;
      gap:12px;
      margin-bottom:10px;
      padding:10px 10px;
      border:1px solid var(--line);
      border-radius:12px;
      background:#141414;
    }
    .money-row .m-label{
      font-weight:1000;
      font-size:16px;
      color:#d7d7d7;
    }
    .money-row .m-value{
      font-weight:1100;
      font-size:22px;
      letter-spacing:-0.3px;
    }
    .money-row .m-value.paid{ color:#7dd3fc; }    /* ë°›ì€ëˆ */
    .money-row .m-value.change{ color:#fca5a5; }  /* ê±°ìŠ¤ë¦„ */

    .money-btns{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      margin-bottom:10px;
    }
    .money-btns button{
      height:52px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#f1f1f1;
      color:#111;
      font-weight:1000;
      font-size:18px;
      cursor:pointer;
    }

    .bottom-row{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
    }
    .reset{
      height:56px;
      border-radius:12px;
      border:none;
      background:var(--danger);
      color:#fff;
      font-weight:1100;
      font-size:20px;
      cursor:pointer;
    }
    .pay{
      height:62px; /* âœ… ê²°ì œì™„ë£Œ í¬ê²Œ */
      border-radius:12px;
      border:none;
      background:var(--ok);
      color:#111;
      font-weight:1200;
      font-size:22px;
      cursor:pointer;
    }

    /* í° í™”ë©´ì—ì„œ ê²°ì œì°½ ì¡°ê¸ˆ ë” ì˜¤ë¥¸ìª½ìœ¼ë¡œ ë°€ì–´ë„ OK: ì´ë¯¸ 3/1 ë¹„ìœ¨ ëŠë‚Œ */
    @media (max-width: 1100px){
      .app{ grid-template-columns: 1.7fr 1fr; }
      .tile{ height:98px; }
    }
    @media (max-width: 820px){
      body{ overflow:auto; }
      .app{
        height:auto;
        grid-template-columns: 1fr;
      }
      .right{ height:520px; }
    }
  </style>
</head>

<body>
  <header>ì—„ê°€ë„¤ í˜„ì¥ ê³„ì‚°ê¸°</header>

  <div class="app">
    <!-- LEFT -->
    <section class="left">
      <div class="topbar">
        <div class="cats" id="cats"></div>
        <div class="search">
          <input id="search" placeholder="ê²€ìƒ‰ (ì˜ˆ: ã„±, ê³ êµ¬ë§ˆ, ê°ìâ€¦)" />
        </div>
      </div>

      <div class="items-wrap">
        <div class="items-grid" id="grid"></div>
      </div>
    </section>

    <!-- RIGHT -->
    <aside class="right">
      <div class="right-header">
        <div class="title-row">
          <div class="right-title">ì¥ë°”êµ¬ë‹ˆ</div>
          <div class="sum">
            <div class="total" id="totalText">â‚©0</div>
            <div class="count" id="countText">ì´ 0ê°œ</div>
          </div>
        </div>
      </div>

      <div class="cart" id="cart"></div>

      <div class="paybox">
        <div class="money-row">
          <div class="m-label">ë°›ì€ëˆ</div>
          <div class="m-value paid" id="paidText">â‚©0</div>
        </div>
        <div class="money-row" style="margin-top:-6px;">
          <div class="m-label">ê±°ìŠ¤ë¦„</div>
          <div class="m-value change" id="changeText">â‚©0</div>
        </div>

        <div class="money-btns">
          <button onclick="addMoney(1000)">1ì²œ</button>
          <button onclick="addMoney(5000)">5ì²œ</button>
          <button onclick="addMoney(10000)">1ë§Œ</button>
          <button onclick="addMoney(30000)">3ë§Œ</button>
          <button onclick="addMoney(50000)">5ë§Œ</button>
          <button onclick="addMoney(100000)">10ë§Œ</button>
        </div>

        <div class="bottom-row">
          <button class="reset" onclick="resetMoneyOnly()">ì´ˆê¸°í™”(ë°›ì€ëˆë§Œ)</button>
          <button class="pay" onclick="complete()">ê²°ì œ ì™„ë£Œ</button>
        </div>
      </div>
    </aside>
  </div>

  <!-- âœ… items.js ë¨¼ì € ë¡œë“œ -->
  <script src="items.js"></script>

  <script>
    // ===== ìƒíƒœ =====
    const CATS = ["ê³¼ì¼","ì•¼ì±„","ìì±„ì†Œ","ìƒì„ "]; // í•„ìš”í•˜ë©´ "ê¸°íƒ€" ì¶”ê°€ ê°€ëŠ¥
    let activeCat = "ê³¼ì¼";
    let keyword = "";

    // cartCounts: { [id]: qty }
    const cartCounts = {};
    let paid = 0;

    function money(n){
      return "â‚©" + (n||0).toLocaleString();
    }

    function getFilteredItems(){
      const items = (window.ITEMS || []).filter(x => x.cat === activeCat);
      if(!keyword.trim()) return items;
      const k = keyword.trim().toLowerCase();
      return items.filter(x => (x.name||"").toLowerCase().includes(k));
    }

    function calcTotal(){
      let total = 0;
      let count = 0;
      for(const id in cartCounts){
        const qty = cartCounts[id];
        if(!qty) continue;
        const item = (window.ITEMS||[]).find(x => x.id === id);
        if(!item) continue;
        total += item.price * qty;
        count += qty;
      }
      return { total, count };
    }

    function updateMoneyUI(){
      const { total } = calcTotal();
      document.getElementById("paidText").innerText = money(paid);
      document.getElementById("changeText").innerText = money(Math.max(paid - total, 0));
    }

    function renderCats(){
      const el = document.getElementById("cats");
      el.innerHTML = "";
      CATS.forEach(cat => {
        const b = document.createElement("button");
        b.className = "cat-btn" + (cat === activeCat ? " active" : "");
        b.textContent = cat;
        b.onclick = () => {
          activeCat = cat;
          renderCats();
          renderItems();
        };
        el.appendChild(b);
      });
    }

    function renderItems(){
      const grid = document.getElementById("grid");
      const items = getFilteredItems();
      grid.innerHTML = "";

      items.forEach(item => {
        const d = document.createElement("div");
        d.className = "tile";
        d.innerHTML = `
          <div class="name">${escapeHtml(item.name)}</div>
          <div class="price">${money(item.price)}</div>
        `;
        d.onclick = () => addToCart(item.id);
        grid.appendChild(d);
      });
    }

    function renderCart(){
      const cart = document.getElementById("cart");
      cart.innerHTML = "";

      const items = (window.ITEMS || []);
      const entries = Object.keys(cartCounts)
        .map(id => ({ id, qty: cartCounts[id] }))
        .filter(x => x.qty > 0);

      // ë¹ˆ ì¥ë°”êµ¬ë‹ˆ
      if(entries.length === 0){
        cart.innerHTML = `<div style="color:#8a8a8a; font-weight:900; padding:10px;">(ë¹„ì–´ìˆìŒ)</div>`;
      } else {
        for(const e of entries){
          const item = items.find(x => x.id === e.id);
          if(!item) continue;

          const row = document.createElement("div");
          row.className = "cart-item";

          const label = document.createElement("div");
          label.className = "label";
          label.textContent = `${item.name}  x${e.qty}`;

          const amt = document.createElement("div");
          amt.className = "amt";
          amt.textContent = money(item.price * e.qty);

          const minus = document.createElement("button");
          minus.className = "mini-btn";
          minus.textContent = "â€“";
          minus.onclick = () => setQty(e.id, e.qty - 1);

          const trash = document.createElement("button");
          trash.className = "mini-btn danger";
          trash.textContent = "ğŸ—‘";
          trash.onclick = () => setQty(e.id, 0);

          row.appendChild(label);
          row.appendChild(amt);
          row.appendChild(minus);
          row.appendChild(trash);
          cart.appendChild(row);
        }
      }

      const { total, count } = calcTotal();
      document.getElementById("totalText").innerText = money(total);
      document.getElementById("countText").innerText = `ì´ ${count}ê°œ`;

      updateMoneyUI();
    }

    function addToCart(id){
      cartCounts[id] = (cartCounts[id] || 0) + 1;
      renderCart();
    }

    function setQty(id, qty){
      if(qty <= 0) delete cartCounts[id];
      else cartCounts[id] = qty;
      renderCart();
    }

    // ===== ê²°ì œ =====
    function addMoney(amount){
      paid += amount;
      updateMoneyUI();
    }

    // âœ… ì´ˆê¸°í™”: ë°›ì€ëˆë§Œ 0 (ì¥ë°”êµ¬ë‹ˆ ìœ ì§€)
    function resetMoneyOnly(){
      paid = 0;
      updateMoneyUI();
    }

    function complete(){
      const { total, count } = calcTotal();
      if(count === 0){
        alert("ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ìˆì–´ìš”!");
        return;
      }
      const change = Math.max(paid - total, 0);
      alert(`ê²°ì œ ì™„ë£Œ!\nì´í•©ê³„: ${money(total)}\në°›ì€ëˆ: ${money(paid)}\nê±°ìŠ¤ë¦„: ${money(change)}`);

      // ê²°ì œ í›„: ì¥ë°”êµ¬ë‹ˆ ë¹„ìš°ê³ (í˜„ì¥ ê¸°ë³¸), ë°›ì€ëˆë„ 0
      for(const k in cartCounts) delete cartCounts[k];
      paid = 0;
      renderCart();
    }

    function escapeHtml(s){
      return String(s)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    // ê²€ìƒ‰
    document.getElementById("search").addEventListener("input", (e) => {
      keyword = e.target.value || "";
      renderItems();
    });

    // ì´ˆê¸° ë Œë”
    renderCats();
    renderItems();
    renderCart();
  </script>
</body>
</html>
