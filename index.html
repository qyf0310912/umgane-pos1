<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì—„ê°€ë„¤ í˜„ì¥ ê³„ì‚°ê¸°</title>

  <style>
    :root{
      --bg:#0b0b0b;
      --panel:#151515;
      --txt:#f2f2f2;
      --muted:#bdbdbd;
      --orange:#ff7a00;
      --green:#2ecc71;
      --red:#ff3b30;
      --radius:16px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background: radial-gradient(1200px 700px at 50% -200px, #222 0%, #0b0b0b 55%, #070707 100%);
      color:var(--txt);
    }
    header{
      background:var(--orange);
      color:#111;
      font-weight:1000;
      text-align:center;
      padding:12px;
      font-size:20px;
      position:sticky;
      top:0;
      z-index:50;
    }

    .page{ padding:12px; }
    .layout{
      display:grid;
      grid-template-columns: 1.55fr 1fr; /* ê²°ì œì°½ 1/3 ì •ë„ */
      gap:12px;
      align-items:start;
    }

    .card{
      background:linear-gradient(180deg, #141414, #0f0f0f);
      border:1px solid #111;
      border-radius: var(--radius);
      overflow:hidden;
    }
    .card-title{
      padding:10px 12px;
      font-weight:900;
      color:#ddd;
      border-bottom:1px solid #111;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .pill{
      color:#9a9a9a;
      font-size:12px;
      font-weight:900;
      white-space:nowrap;
    }

    /* LEFT */
    .left-inner{ padding:12px; }
    .tabs{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-bottom:10px;
    }
    .tab{
      border:1px solid #2a2a2a;
      background:#1a1a1a;
      color:#eee;
      padding:8px 12px;
      border-radius:12px;
      font-weight:900;
      cursor:pointer;
      user-select:none;
    }
    .tab.active{
      outline:2px solid rgba(255,122,0,.5);
      border-color:#3a2a1a;
    }

    .search-row{
      display:flex;
      gap:10px;
      margin:10px 0 12px;
      align-items:center;
    }
    .search{
      width:100%;
      background:#121212;
      border:1px solid #222;
      color:#fff;
      padding:12px 12px;
      border-radius:14px;
      font-size:16px;
      font-weight:900;
      outline:none;
    }
    .search::placeholder{ color:#777; }

    /* âœ… í’ˆëª© íƒ€ì¼í˜• 5ì—´(í°í™”ë©´), ì¤„ë©´ 4/3ì—´ */
    .grid{
      display:grid;
      grid-template-columns: repeat(5, minmax(0,1fr));
      gap:10px;
    }
    @media (max-width: 1400px){
      .grid{ grid-template-columns: repeat(4, minmax(0,1fr)); }
    }
    @media (max-width: 1100px){
      .layout{ grid-template-columns: 1fr; }
      .grid{ grid-template-columns: repeat(4, minmax(0,1fr)); }
    }
    @media (max-width: 820px){
      .grid{ grid-template-columns: repeat(3, minmax(0,1fr)); }
    }

    .item{
      background: linear-gradient(180deg,#1a1a1a,#121212);
      border:1px solid #151515;
      border-radius:18px;
      padding:12px;
      cursor:pointer;
      user-select:none;
      min-height:74px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      gap:8px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    .item:active{ transform: scale(.99); }
    .item .name{
      font-weight:1000;
      font-size:18px;
      line-height:1.05;
    }
    .item .meta{
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      gap:10px;
    }
    .item .unit{
      color:#9b9b9b;
      font-weight:900;
      font-size:13px;
    }
    .item .price{
      font-weight:1100;
      font-size:18px;
      color:#fff;
    }

    /* RIGHT */
    .right-inner{
      display:flex;
      flex-direction:column;
      height: calc(100vh - 56px); /* í—¤ë” ì œì™¸ */
      min-height:540px;
    }

    /* âœ… ì´í•©ê³„ + ì´ê°¯ìˆ˜ */
    .sum{
      padding:12px;
      font-size:24px;
      font-weight:1100;
      border-bottom:1px solid #111;
      background:linear-gradient(180deg,#111,#0e0e0e);
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:10px;
    }
    .sum .leftsum{ display:flex; gap:10px; align-items:baseline; flex-wrap:wrap; }
    .sum .badge{
      background:#1b1b1b;
      border:1px solid #222;
      padding:6px 10px;
      border-radius:999px;
      font-weight:1000;
      font-size:14px;
      color:#ddd;
    }

    /* âœ… ì¥ë°”êµ¬ë‹ˆë§Œ ìŠ¤í¬ë¡¤ + ë” ë§ì´ ë³´ì´ê²Œ(ì»´íŒ©íŠ¸) */
    .cart-scroll{
      padding:8px;
      overflow:auto;
      flex: 1 1 auto;
      border-bottom:1px solid #111;
    }
    .cart-row{
      display:grid;
      grid-template-columns: 1fr auto;
      gap:8px;
      align-items:center;
      padding:8px 8px;                /* âœ… ì¤„ì„ */
      border-radius:14px;
      background:rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.04);
      margin-bottom:6px;              /* âœ… ì¤„ì„ */
    }

    .row-main{
      display:flex;
      flex-direction:column;
      gap:2px;                        /* âœ… ì¤„ì„ */
      min-width:0;
    }
    .row-top{
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:center;
      min-width:0;
    }
    .cart-name{
      font-weight:1000;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width:100%;
    }
    .cart-total{
      font-weight:1100;
      white-space:nowrap;
    }

    .row-bottom{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .row-bottom small{
      color:#a8a8a8;
      font-weight:900;
      font-size:12px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .qtybox{
      display:flex;
      align-items:center;
      gap:6px;
      flex-shrink:0;
    }
    .qbtn{
      width:34px;                     /* âœ… ì¡°ê¸ˆ ì¤„ì„ */
      height:34px;
      border:none;
      border-radius:12px;
      font-weight:1100;
      cursor:pointer;
      background:#2a2a2a;
      color:#fff;
    }
    .qnum{
      min-width:38px;
      text-align:center;
      font-weight:1100;
      font-size:16px;
      color:#fff;
    }
    .trash{
      width:38px;
      height:38px;
      border:none;
      border-radius:12px;
      cursor:pointer;
      background: var(--red);
      color:#fff;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-size:16px;
      font-weight:1000;
    }

    /* âœ… ê²°ì œì˜ì—­ ì•„ë˜ ê³ ì • */
    .pay-sticky{
      padding:10px 12px;
      background:linear-gradient(180deg,#0f0f0f,#0b0b0b);
    }

    /* ë°›ì€ëˆ/ê±°ìŠ¤ë¦„ ë¶„ë¦¬ ì¹´ë“œ */
    .paidbox{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-bottom:10px;
    }
    .paidcard{
      border-radius:16px;
      padding:10px 10px;              /* âœ… ì‚´ì§ ì¤„ì„ */
      border:1px solid #111;
    }
    .paidcard .t{
      font-size:13px;
      font-weight:1000;
      opacity:.9;
      margin-bottom:6px;
    }
    .paidcard .v{
      font-size:24px;
      font-weight:1200;
      letter-spacing:0.2px;
    }
    .paid-in{
      background:linear-gradient(180deg,#10233a,#0f1b2b);
      border-color:#0b2a4a;
    }
    .paid-in .t{ color:#9fd0ff; }
    .paid-in .v{ color:#d7ecff; }
    .paid-change{
      background:linear-gradient(180deg,#0f2f1e,#0f241a);
      border-color:#144b2b;
    }
    .paid-change .t{ color:#9dffb5; }
    .paid-change .v{ color:#d8ffe5; }

    /* ëˆë²„íŠ¼ (âœ… 10ë§Œ ì‚­ì œ + ê°„ê²© ì •ë¦¬) */
    .money{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      margin-bottom:10px;
    }
    .mbtn{
      border:none;
      border-radius:14px;
      padding:14px 10px;
      background:#f1f1f1;
      color:#111;
      font-weight:1100;
      font-size:18px;
      cursor:pointer;
    }
    .mbtn:active{ transform: scale(.99); }

    /* âœ… ë²„íŠ¼ 2ê°œë§Œ: ì´ˆê¸°í™”(í˜„ê¸ˆë§Œ) / ê²°ì œì™„ë£Œ(ì „ì²´) */
    .actions{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
    }
    .btn-reset{
      background: var(--red);
      color:#fff;
      border:none;
      border-radius:16px;
      padding:16px 12px;
      font-weight:1200;
      font-size:18px;
      cursor:pointer;
    }
    .btn-done{
      background: var(--green);
      color:#111;
      border:none;
      border-radius:18px;
      padding:18px 12px;
      font-weight:1300;
      font-size:22px;
      cursor:pointer;
    }
    .btn-reset:active, .btn-done:active{ transform: scale(.99); }

    .hint{
      color:#777;
      font-size:12px;
      font-weight:800;
      margin-top:8px;
      text-align:center;
    }
  </style>
</head>

<body>
<header>ì—„ê°€ë„¤ í˜„ì¥ ê³„ì‚°ê¸°</header>

<div class="page">
  <div class="layout">

    <!-- LEFT: í’ˆëª© -->
    <div class="card">
      <div class="card-title">
        <div>í’ˆëª© ì„ íƒ</div>
        <div class="pill">ê²€ìƒ‰(ì´ˆì„±) Â· íƒ€ì¼í˜•</div>
      </div>

      <div class="left-inner">
        <div class="tabs" id="tabs"></div>

        <div class="search-row">
          <input id="q" class="search" placeholder="ê²€ìƒ‰: ê³ êµ¬ë§ˆ / ã„± / ì‚¬ê³¼ / ë‹¨ê°(3ê°œ) ..." autocomplete="off" />
        </div>

        <div class="grid" id="grid"></div>
      </div>
    </div>

    <!-- RIGHT: ê²°ì œ -->
    <div class="card">
      <div class="card-title">
        <div>ê²°ì œ</div>
        <div class="pill">ì¥ë°”êµ¬ë‹ˆë§Œ ìŠ¤í¬ë¡¤</div>
      </div>

      <div class="right-inner">
        <div class="sum">
          <div class="leftsum">
            <div>ì´í•©ê³„ <span id="total">â‚©0</span></div>
            <div class="badge">ì´ <span id="count">0</span>ê°œ</div>
          </div>
        </div>

        <div class="cart-scroll" id="cart"></div>

        <div class="pay-sticky">
          <div class="paidbox">
            <div class="paidcard paid-in">
              <div class="t">ë°›ì€ëˆ</div>
              <div class="v">â‚©<span id="paid">0</span></div>
            </div>
            <div class="paidcard paid-change">
              <div class="t">ê±°ìŠ¤ë¦„</div>
              <div class="v">â‚©<span id="change">0</span></div>
            </div>
          </div>

          <!-- âœ… 10ë§Œ ì œê±° -->
          <div class="money">
            <button class="mbtn" onclick="addMoney(1000)">1ì²œ</button>
            <button class="mbtn" onclick="addMoney(5000)">5ì²œ</button>
            <button class="mbtn" onclick="addMoney(10000)">1ë§Œ</button>
            <button class="mbtn" onclick="addMoney(30000)">3ë§Œ</button>
            <button class="mbtn" onclick="addMoney(50000)">5ë§Œ</button>
            <button class="mbtn" onclick="addMoney(0)">0</button>
          </div>

          <div class="actions">
            <!-- âœ… ì´ˆê¸°í™”: ë°›ì€ëˆ/ê±°ìŠ¤ë¦„ë§Œ -->
            <button class="btn-reset" onclick="resetCashOnly()">ì´ˆê¸°í™”(í˜„ê¸ˆë§Œ)</button>
            <!-- âœ… ê²°ì œì™„ë£Œ: ì „ì²´ ì´ˆê¸°í™” -->
            <button class="btn-done" onclick="complete()">ê²°ì œ ì™„ë£Œ</button>
          </div>

          <div class="hint">F5 ìƒˆë¡œê³ ì¹¨í•˜ë©´ ì „ë¶€ ì‚¬ë¼ì§ / ì´ˆê¸°í™”ëŠ” í˜„ê¸ˆë§Œ 0</div>
        </div>
      </div>
    </div>

  </div>
</div>

<script src="items.js"></script>

<script>
  // ---------- ìœ í‹¸ ----------
  const fmt = (n)=> "â‚©" + (n||0).toLocaleString("ko-KR");

  // ì´ˆì„± í…Œì´ë¸”
  const CHO = ["ã„±","ã„²","ã„´","ã„·","ã„¸","ã„¹","ã…","ã…‚","ã…ƒ","ã……","ã…†","ã…‡","ã…ˆ","ã…‰","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
  function getChosung(str){
    let out = "";
    for (const ch of str){
      const code = ch.charCodeAt(0);
      if (code >= 0xAC00 && code <= 0xD7A3){
        const idx = Math.floor((code - 0xAC00) / 588);
        out += CHO[idx] || "";
      } else if (/[a-z0-9]/i.test(ch)){
        out += ch.toLowerCase();
      } else {
        out += ch;
      }
    }
    return out;
  }
  function norm(s){ return (s||"").toString().trim().toLowerCase(); }

  // ---------- ë°ì´í„° ----------
  const ITEMS = Array.isArray(window.ITEMS) ? window.ITEMS : [];
  const CATS = ["ê³¼ì¼","ì•¼ì±„","ìì±„ì†Œ","ìƒì„ ","ê¸°íƒ€","ë¬¶ìŒ"];

  // ---------- ìƒíƒœ ----------
  let activeCat = "ê³¼ì¼";
  let query = "";
  const cart = {};
  let total = 0;
  let paid = 0;

  // ---------- DOM ----------
  const $tabs = document.getElementById("tabs");
  const $grid = document.getElementById("grid");
  const $cart = document.getElementById("cart");
  const $total = document.getElementById("total");
  const $count = document.getElementById("count");
  const $paid = document.getElementById("paid");
  const $change = document.getElementById("change");
  const $q = document.getElementById("q");

  function buildTabs(){
    $tabs.innerHTML = "";
    for (const c of CATS){
      const b = document.createElement("div");
      b.className = "tab" + (c===activeCat ? " active" : "");
      b.textContent = c;
      b.onclick = ()=>{ activeCat = c; buildTabs(); renderItems(); };
      $tabs.appendChild(b);
    }
  }

  function itemMatches(it){
    const catOk = (activeCat==="ë¬¶ìŒ") ? (it.unit === "ë¬¶ìŒ") : (it.cat === activeCat);
    if (!catOk) return false;
    if (!query) return true;

    const q = norm(query);
    const n = norm(it.name);
    const u = norm(it.unit);
    const ch = getChosung(it.name);

    return n.includes(q) || u.includes(q) || ch.includes(q);
  }

  function makeItemTile(it){
    const d = document.createElement("div");
    d.className = "item";
    d.onclick = ()=> addItem(it.id);

    const name = document.createElement("div");
    name.className = "name";
    name.textContent = it.name;

    const meta = document.createElement("div");
    meta.className = "meta";

    const unit = document.createElement("div");
    unit.className = "unit";
    unit.textContent = it.unit;

    const price = document.createElement("div");
    price.className = "price";
    price.textContent = fmt(it.price);

    meta.appendChild(unit);
    meta.appendChild(price);

    d.appendChild(name);
    d.appendChild(meta);
    return d;
  }

  function renderItems(){
    $grid.innerHTML = "";
    const list = ITEMS.filter(itemMatches);
    for (const it of list) $grid.appendChild(makeItemTile(it));
  }

  function calcTotal(){
    let t = 0;
    let c = 0;
    for (const k in cart){
      t += cart[k].price * cart[k].qty;
      c += cart[k].qty; // âœ… ì´ê°¯ìˆ˜
    }
    total = t;
    $total.textContent = fmt(total);
    $count.textContent = c.toLocaleString("ko-KR");
    updateChange();
  }

  function renderCart(){
    $cart.innerHTML = "";
    const keys = Object.keys(cart);
    if (!keys.length){
      const empty = document.createElement("div");
      empty.style.color = "#777";
      empty.style.fontWeight = "900";
      empty.style.padding = "14px 10px";
      empty.textContent = "ì¥ë°”êµ¬ë‹ˆ ë¹„ì–´ìˆìŒ";
      $cart.appendChild(empty);
      return;
    }

    for (const id of keys){
      const row = cart[id];

      const wrap = document.createElement("div");
      wrap.className = "cart-row";

      const main = document.createElement("div");
      main.className = "row-main";

      const top = document.createElement("div");
      top.className = "row-top";

      const nm = document.createElement("div");
      nm.className = "cart-name";
      nm.textContent = `${row.name} x${row.qty}`;

      const tot = document.createElement("div");
      tot.className = "cart-total";
      tot.textContent = fmt(row.price * row.qty);

      top.appendChild(nm);
      top.appendChild(tot);

      const bottom = document.createElement("div");
      bottom.className = "row-bottom";

      const sm = document.createElement("small");
      sm.textContent = `${row.unit} Â· ${fmt(row.price)} (ê°œë‹¹)`;

      const controls = document.createElement("div");
      controls.className = "qtybox";
      controls.innerHTML = `
        <button class="qbtn" title="1ê°œ ë¹¼ê¸°">-</button>
        <div class="qnum">${row.qty}</div>
        <button class="qbtn" title="1ê°œ ì¶”ê°€">+</button>
        <button class="trash" title="í•­ëª© ì‚­ì œ">ğŸ—‘</button>
      `;
      const [minus, , plus, trash] = controls.children;
      minus.onclick = ()=> decItem(id);
      plus.onclick  = ()=> incItem(id);
      trash.onclick = ()=> delItem(id);

      bottom.appendChild(sm);
      bottom.appendChild(controls);

      main.appendChild(top);
      main.appendChild(bottom);

      wrap.appendChild(main);
      $cart.appendChild(wrap);
    }
  }

  // ---------- ë™ì‘ ----------
  function addItem(id){
    const it = ITEMS.find(x=>x.id===id);
    if (!it) return;
    if (!cart[id]){
      cart[id] = { id:it.id, name:it.name, unit:it.unit, price:it.price, qty:1 };
    } else {
      cart[id].qty += 1;
    }
    calcTotal();
    renderCart();
  }
  function incItem(id){
    if (!cart[id]) return;
    cart[id].qty += 1;
    calcTotal();
    renderCart();
  }
  function decItem(id){
    if (!cart[id]) return;
    cart[id].qty -= 1;
    if (cart[id].qty <= 0) delete cart[id];
    calcTotal();
    renderCart();
  }
  function delItem(id){
    if (!cart[id]) return;
    delete cart[id];
    calcTotal();
    renderCart();
  }

  function addMoney(amount){
    // 0 ë²„íŠ¼ì€ ì‹¤ìˆ˜ ë°©ì§€ìš©(ì›í•˜ë©´ ë‚˜ì¤‘ì— ë‹¤ë¥¸ ê±¸ë¡œ ë°”ê¿”ë„ ë¨)
    if (amount <= 0) return;
    paid += amount;
    $paid.textContent = paid.toLocaleString("ko-KR");
    updateChange();
  }

  function updateChange(){
    const ch = Math.max(paid - total, 0);
    $change.textContent = ch.toLocaleString("ko-KR");
  }

  // âœ… ì´ˆê¸°í™”: ë°›ì€ëˆ/ê±°ìŠ¤ë¦„ë§Œ 0
  function resetCashOnly(){
    paid = 0;
    $paid.textContent = "0";
    $change.textContent = "0";
  }

  // âœ… ê²°ì œì™„ë£Œ: ì „ì²´ ì´ˆê¸°í™”
  function complete(){
    if (total <= 0){
      alert("ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ìˆìŒ");
      return;
    }
    alert("ê²°ì œ ì™„ë£Œ!");
    for (const k in cart) delete cart[k];
    total = 0;
    paid = 0;
    $paid.textContent = "0";
    $change.textContent = "0";
    $total.textContent = fmt(0);
    $count.textContent = "0";
    renderCart();
  }

  // ê²€ìƒ‰
  $q.addEventListener("input", ()=>{
    query = $q.value || "";
    renderItems();
  });

  // ì‹œì‘
  buildTabs();
  renderItems();
  renderCart();
  calcTotal();
</script>

</body>
</html>
